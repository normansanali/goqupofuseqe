<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="I would like to convert from an image (like jpg or png) to PDF. I've checked out ImageMagickNET, but it is far too complex for my needs. What other .NET solutions or code are there for converting an image to a PDF?"><meta name=generator content="Hugo 0.98.0"><meta name=robots content="index,follow,noarchive"><title>JPG to PDF Convertor in C# &#183;</title><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css><!--[if lte IE 8]><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css><![endif]--><!--[if gt IE 8]><!--><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css><!--<![endif]--><!--[if lte IE 8]><link rel=stylesheet href=https://assets.cdnweb.info/hugo/blackburn/css/side-menu-old-ie.css><![endif]--><!--[if gt IE 8]><!--><link rel=stylesheet href=https://assets.cdnweb.info/hugo/blackburn/css/side-menu.css><!--<![endif]--><link rel=stylesheet href=https://assets.cdnweb.info/hugo/blackburn/css/blackburn.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel=stylesheet type=text/css><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css><script async src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js></script>
<script>hljs.initHighlightingOnLoad()</script><link rel="shortcut icon" href=./img/favicon.ico type=image/x-icon></head><body><div id=layout><a href=#menu id=menuLink class=menu-link><span></span></a><div id=menu><a class="pure-menu-heading brand" href=./index.html>JadeBlog</a><div class=pure-menu><ul class=pure-menu-list><li class=pure-menu-item><a class=pure-menu-link href=./index.html><i class="fa fa-home fa-fw"></i>Home</a></li><li class=pure-menu-item><a class=pure-menu-link href=./post/index.html><i class="fa fa-list fa-fw"></i>Posts</a></li><li class=pure-menu-item><a class=pure-menu-link href=./sitemap.xml><i class="fa fa-user fa-fw"></i>Sitemap</a></li><li class=pure-menu-item><a class=pure-menu-link href=./index.xml><i class="fa fa-phone fa-fw"></i>RSS</a></li></ul></div><div class="pure-menu social"><ul class=pure-menu-list></ul></div><div><div class=small-print><small>&copy; 2022. All rights reserved.</small></div><div class=small-print><small>Built with&nbsp;<a href=https://gohugo.io/ target=_blank>Hugo</a></small>
<small>Theme&nbsp;<a href=https://github.com/yoshiharuyamashita/blackburn target=_blank>Blackburn</a></small></div></div></div><div id=main><div class=header><h1>JPG to PDF Convertor in C#</h1><h2>I would like to convert from an image (like jpg or png) to PDF. I've checked out ImageMagickNET, but it is far too complex for my needs. What other .NET solutions or code are there for converting an image to a PDF?</h2></div><div class=content><div class=post-meta><div><i class="fa fa-calendar fa-fw"></i>
<time>27 Sep 2024, 00:00</time></div></div><img src=https://cdn.statically.io/img/cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png style=margin:auto;display:block;text-align:center;max-width:100%;height:auto><p>I would like to convert from an image (like jpg or png) to PDF.</p><p>I've checked out <a href=# rel=noreferrer>ImageMagickNET</a>, but it is far too complex for my needs.</p><p>What other .NET solutions or code are there for converting an image to a PDF?</p><span class=d-none itemprop=commentCount>3</span><h2 class=mb0 data-answercount=11>11 Answers</h2><p>Easy with <a href=# rel=noreferrer>iTextSharp</a>:</p><pre><code>class Program { static void Main(string[] args) { Document document = new Document(); using (var stream = new FileStream("test.pdf", FileMode.Create, FileAccess.Write, FileShare.None)) { PdfWriter.GetInstance(document, stream); document.Open(); using (var imageStream = new FileStream("test.jpg", FileMode.Open, FileAccess.Read, FileShare.ReadWrite)) { var image = Image.GetInstance(imageStream); document.Add(image); } document.Close(); } } } </code></pre><span class=d-none itemprop=commentCount>4</span><p><a href=# rel=noreferrer>iTextSharp</a> does it pretty cleanly and is open source. Also, it has <a href=# rel=noreferrer>a very good accompanying book by the author</a> which I recommend if you end up doing more interesting things like managing forms. For normal usage, there are plenty resources on mailing lists and newsgroups for samples of how to do common things.</p><p>EDIT: as alluded to in <a href=#>@Chirag's comment</a>, <a href=#>@Darin's answer</a> has code that definitely compiles with current versions.</p><p>Example usage:</p><pre><code>public static void ImagesToPdf(string[] imagepaths, string pdfpath) { using(var doc = new iTextSharp.text.Document()) { iTextSharp.text.pdf.PdfWriter.GetInstance(doc, new FileStream(pdfpath, FileMode.Create)); doc.Open(); foreach (var item in imagepaths) { iTextSharp.text.Image image = iTextSharp.text.Image.GetInstance(item); doc.Add(image); } } } </code></pre><span class=d-none itemprop=commentCount>5</span><p>Another working code, try it</p><pre><code>public void ImagesToPdf(string[] imagepaths, string pdfpath) { iTextSharp.text.Rectangle pageSize = null; using (var srcImage = new Bitmap(imagepaths[0].ToString())) { pageSize = new iTextSharp.text.Rectangle(0, 0, srcImage.Width, srcImage.Height); } using (var ms = new MemoryStream()) { var document = new iTextSharp.text.Document(pageSize, 0, 0, 0, 0); iTextSharp.text.pdf.PdfWriter.GetInstance(document, ms).SetFullCompression(); document.Open(); var image = iTextSharp.text.Image.GetInstance(imagepaths[0].ToString()); document.Add(image); document.Close(); File.WriteAllBytes(pdfpath+"cheque.pdf", ms.ToArray()); } } </code></pre><span class=d-none itemprop=commentCount>1</span><p>One we've had great luck with is PDFSharp (we use it for TIFF and Text to PDF conversion for hundreds of medical claims every day).</p><p><a href=# rel=noreferrer>http://pdfsharp.com/PDFsharp/</a></p><span class=d-none itemprop=commentCount>1</span><p>Such task can be easily done with help of <a href=# rel="nofollow noreferrer">Docotic.Pdf library</a>.</p><p>Here is a sample that creates PDF from given images (not only JPGs, actually):</p><pre><code>public static void imagesToPdf(string[] images, string pdfName) { using (PdfDocument pdf = new PdfDocument()) { for (int i = 0; i &lt; images.Length; i++) { if (i &gt; 0) pdf.AddPage(); PdfPage page = pdf.Pages[i]; string imagePath = images[i]; PdfImage pdfImage = pdf.AddImage(imagePath); page.Width = pdfImage.Width; page.Height = pdfImage.Height; page.Canvas.DrawImage(pdfImage, 0, 0); } pdf.Save(pdfName); } } </code></pre><p>Disclaimer: I work for the vendor of the library.</p><span class=d-none itemprop=commentCount></span><p>If you want to do it in a cross-platform way, without any thirty part library, or paying any license, you can use this code. It takes an array of pictures (I think it only works only with jpg) with its sizes and return a pdf file, with one picture per page.</p><p>You have to create two files:</p><p>File Picture:</p><pre><code>using System; using System.Collections.Generic; using System.Text; namespace PDF { public class Picture { private byte[] data; private int width; private int height; public byte[] Data { get =&gt; data; set =&gt; data = value; } public int Width { get =&gt; width; set =&gt; width = value; } public int Height { get =&gt; height; set =&gt; height = value; } } } </code></pre><p>File PDFExport:</p><pre><code>using System; using System.Collections.Generic; namespace PDF { public class PDFExport { private string company = "Your Company Here"; public sbyte[] createFile(List&lt;Picture&gt; pictures) { int N = (pictures.Count + 1) * 3; string dateTimeStr = DateTime.Now.ToString("yyyyMMddhhmmss"); string file1 = "%PDF-1.4\n"; string file2 = "2 0 obj\n" + "&lt;&lt;\n" + "/Type /Pages\n" + getKids(pictures) + "/Count " + pictures.Count + "\n" + "&gt;&gt;\n" + "endobj\n" + "1 0 obj\n" + "&lt;&lt;\n" + "/Type /Catalog\n" + "/Pages 2 0 R\n" + "/PageMode /UseNone\n" + "/PageLayout /SinglePage\n" + "/Metadata 7 0 R\n" + "&gt;&gt;\n" + "endobj\n" + N + " 0 obj\n" + "&lt;&lt;\n" + "/Creator(" + company + ")\n" + "/Producer(" + company + ")\n" + "/CreationDate (D:" + dateTimeStr + ")\n" + "/ModDate (D:" + dateTimeStr + ")\n" + "&gt;&gt;\n" + "endobj\n" + "xref\n" + "0 " + (N + 1) + "\n" + "0000000000 65535 f\n" + "0000224088 00000 n\n" + "0000224031 00000 n\n" + "0000000015 00000 n\n" + "0000222920 00000 n\n" + "0000222815 00000 n\n" + "0000224153 00000 n\n" + "0000223050 00000 n\n" + "trailer\n" + "&lt;&lt;\n" + "/Size " + (N + 1) + "\n" + "/Root 1 0 R\n" + "/Info 6 0 R\n" + "&gt;&gt;\n" + "startxref\n" + "0\n" + "%% EOF"; sbyte[] part1 = file1.GetBytes(); sbyte[] part2 = file2.GetBytes(); List&lt;sbyte[]&gt; fileContents = new List&lt;sbyte[]&gt;(); fileContents.Add(part1); for (int i = 0; i &lt; pictures.Count; i++) { fileContents.Add(getPageFromImage(pictures[i], i)); } fileContents.Add(part2); return getFileContent(fileContents); } private string getKids(List&lt;Picture&gt; pictures) { string kids = "/Kids["; for (int i = 0; i &lt; pictures.Count; i++) { kids += (3 * (i + 1) + 1) + " 0 R "; } kids += "]\n"; return kids; } private sbyte[] getPageFromImage(Picture picture, int P) { int N = (P + 1) * 3; string imageStart = N + " 0 obj\n" + "&lt;&lt;\n" + "/Type /XObject\n" + "/Subtype /Image\n" + "/Width " + picture.Width + "\n" + "/Height " + picture.Height + "\n" + "/BitsPerComponent 8\n" + "/ColorSpace /DeviceRGB\n" + "/Filter /DCTDecode\n" + "/Length " + picture.Data.Length + "\n" + "&gt;&gt;\n" + "stream\n"; string dimentions = "q\n" + picture.Width + " 0 0 " + picture.Height + " 0 0 cm\n" + "/X0 Do\n" + "Q\n"; string imageEnd = "\nendstream\n" + "endobj\n" + (N + 2) + " 0 obj\n" + "&lt;&lt;\n" + "/Filter []\n" + "/Length " + dimentions.Length + "\n" + "&gt;&gt;\n" + "stream\n"; string page = "\nendstream\n" + "endobj\n" + (N + 1) + " 0 obj\n" + "&lt;&lt;\n" + "/Type /Page\n" + "/MediaBox[0 0 " + picture.Width + " " + picture.Height + "]\n" + "/Resources &lt;&lt;\n" + "/XObject &lt;&lt;\n" + "/X0 " + N + " 0 R\n" + "&gt;&gt;\n" + "&gt;&gt;\n" + "/Contents 5 0 R\n" + "/Parent 2 0 R\n" + "&gt;&gt;\n" + "endobj\n"; List&lt;sbyte[]&gt; fileContents = new List&lt;sbyte[]&gt;(); fileContents.Add(imageStart.GetBytes()); fileContents.Add(byteArrayToSbyteArray(picture.Data)); fileContents.Add(imageEnd.GetBytes()); fileContents.Add(dimentions.GetBytes()); fileContents.Add(page.GetBytes()); return getFileContent(fileContents); } private sbyte[] byteArrayToSbyteArray(byte[] data) { sbyte[] data2 = new sbyte[data.Length]; for (int i = 0; i &lt; data2.Length; i++) { data2[i] = (sbyte)data[i]; } return data2; } private sbyte[] getFileContent(List&lt;sbyte[]&gt; fileContents) { int fileSize = 0; foreach (sbyte[] content in fileContents) { fileSize += content.Length; } sbyte[] finaleFile = new sbyte[fileSize]; int index = 0; foreach (sbyte[] content in fileContents) { for (int i = 0; i &lt; content.Length; i++) { finaleFile[index + i] = content[i]; } index += content.Length; } return finaleFile; } } } </code></pre><p>You can use the code in this easy way</p><p>///////////////////////////////////////Export PDF//////////////////////////////////////</p><pre><code> private sbyte[] exportPDF(List&lt;Picture&gt; images) { if (imageBytesList.Count &gt; 0) { PDFExport pdfExport = new PDFExport(); sbyte[] fileData = pdfExport.createFile(images); return fileData; } return null; } </code></pre><span class=d-none itemprop=commentCount></span><p>You need Acrobat to be installed. Tested on Acrobat DC. This is a VB.net code. Due to that these objects are COM objects, you shall do a 'release object', not just a '=Nothing". You can convert this code here: <a href=# rel="nofollow noreferrer">https://converter.telerik.com/</a></p><pre class="lang-vb prettyprint-override"><code>Private Function ImageToPDF(ByVal FilePath As String, ByVal DestinationFolder As String) As String Const PDSaveCollectGarbage As Integer = 32 Const PDSaveLinearized As Integer = 4 Const PDSaveFull As Integer = 1 Dim PDFAVDoc As Object = Nothing Dim PDFDoc As Object = Nothing Try 'Check destination requirements If Not DestinationFolder.EndsWith("\") Then DestinationFolder += "\" If Not System.IO.Directory.Exists(DestinationFolder) Then Throw New Exception("Destination directory does not exist: " &amp; DestinationFolder) Dim CreatedFile As String = DestinationFolder &amp; System.IO.Path.GetFileNameWithoutExtension(FilePath) &amp; ".pdf" 'Avoid conflicts, therefore previous file there will be deleted If File.Exists(CreatedFile) Then File.Delete(CreatedFile) 'Get PDF document PDFAVDoc = GetPDFAVDoc(FilePath) PDFDoc = PDFAVDoc.GetPDDoc If Not PDFDoc.Save(PDSaveCollectGarbage Or PDSaveLinearized Or PDSaveFull, CreatedFile) Then Throw New Exception("PDF file cannot be saved: " &amp; PDFDoc.GetFileName()) If Not PDFDoc.Close() Then Throw New Exception("PDF file could not be closed: " &amp; PDFDoc.GetFileName()) PDFAVDoc.Close(1) Return CreatedFile Catch Ex As Exception Throw Ex Finally System.Runtime.InteropServices.Marshal.ReleaseComObject(PDFDoc) System.Runtime.InteropServices.Marshal.FinalReleaseComObject(PDFDoc) PDFDoc = Nothing System.Runtime.InteropServices.Marshal.ReleaseComObject(PDFAVDoc) System.Runtime.InteropServices.Marshal.FinalReleaseComObject(PDFAVDoc) PDFAVDoc = Nothing GC.Collect() GC.WaitForPendingFinalizers() GC.Collect() End Try End Function </code></pre><span class=d-none itemprop=commentCount></span><p>not sure if you're looking for just free / open source solutions or considering commercial ones as well. But if you're including commercial solutions, there's a toolkit called EasyPDF SDK that offers an API for converting images (plus a number of other file types) to PDF. It supports C# and can be found here:</p><pre><code> http://www.pdfonline.com/ </code></pre><p>The C# code would look as follows:</p><pre><code> Printer oPrinter = new Printer(); ImagePrintJob oPrintJob = oPrinter.ImagePrintJob; oPrintJob.PrintOut(imageFile, pdfFile); </code></pre><p>To be fully transparent, I should disclaim that I do work for the makers of EasyPDF SDK (hence my handle), so this suggestion is not without some personal bias :) But feel free to check out the eval version if you're interested. Cheers!</p><span class=d-none itemprop=commentCount></span><p>I use Sautinsoft, its very simple:</p><pre><code>SautinSoft.PdfMetamorphosis p = new SautinSoft.PdfMetamorphosis(); p.Serial="xxx"; p.HtmlToPdfConvertStringToFile("&lt;html&gt;&lt;body&gt;&lt;img src=\""+filename+"\"&gt;&lt;/img&gt;&lt;/body&gt;&lt;/html&gt;","output.pdf"); </code></pre><span class=d-none itemprop=commentCount></span><p>You may try to convert any Images to PDF using this code sample:</p><pre><code>PdfVision v = new PdfVision(); ImageToPdfOptions options = new ImageToPdfOptions(); options.JpegQuality = 95; try { v.ConvertImageToPdf(new string[] {inpFile}, outFile, options); System.Diagnostics.Process.Start(new System.Diagnostics.ProcessStartInfo(outFile) { UseShellExecute = true }); } catch (Exception ex) { Console.WriteLine($"Error: {ex.Message}"); Console.ReadLine(); } </code></pre><p>Or if you need to convert Image Class to PDF:</p><pre><code>System.Drawing.Image image = Image.FromFile(@"..\..\image-jpeg.jpg"); string outFile = new FileInfo(@"Result.pdf").FullName; PdfVision v = new PdfVision(); ImageToPdfOptions options = new ImageToPdfOptions(); options.PageSetup.PaperType = PaperType.Auto; byte[] imgBytes = null; using (MemoryStream ms = new System.IO.MemoryStream()) { image.Save(ms, System.Drawing.Imaging.ImageFormat.Jpeg); imgBytes = ms.ToArray(); } try { v.ConvertImageToPdf(imgBytes, outFile, options); System.Diagnostics.Process.Start(new System.Diagnostics.ProcessStartInfo(outFile) { UseShellExecute = true }); } catch (Exception ex) { Console.WriteLine($"Error: {ex.Message}"); Console.ReadLine(); } </code></pre><span class=d-none itemprop=commentCount></span><p>Many diff tools out there. One I use is PrimoPDF (FREE) <a href=# rel="nofollow noreferrer">http://www.primopdf.com/</a> you go to print the file and you print it to pdf format onto your drive. works on Windows</p><span class=d-none itemprop=commentCount>1</span><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmirpJawrLvVnqmfpJ%2Bse6S7zGiorp2jqbawutJoaG9sYmeFcXvJqZ5mrJ9ivaWyjJymp66Vp8GwvoyipWabXai1or7P</p><h4><i class="fas fa-share-alt" aria-hidden=true></i>&nbsp;Share!</h4><ul class=share-buttons><li><a href="https://www.facebook.com/sharer/sharer.php?u=%2fjpg-to-pdf-convertor-in-c-sharp.html" target=_blank title="Share on Facebook"><i class="fab fa-facebook" aria-hidden=true></i><span class=sr-only>Share on Facebook</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="https://twitter.com/intent/tweet?source=%2fjpg-to-pdf-convertor-in-c-sharp.html" target=_blank title=Tweet><i class="fab fa-twitter" aria-hidden=true></i><span class=sr-only>Tweet</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="https://plus.google.com/share?url=%2fjpg-to-pdf-convertor-in-c-sharp.html" target=_blank title="Share on Google+"><i class="fab fa-google-plus" aria-hidden=true></i><span class=sr-only>Share on Google+</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="http://www.tumblr.com/share?v=3&u=%2fjpg-to-pdf-convertor-in-c-sharp.html" target=_blank title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden=true></i><span class=sr-only>Post to Tumblr</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="http://pinterest.com/pin/create/button/?url=%2fjpg-to-pdf-convertor-in-c-sharp.html" target=_blank title="Pin it"><i class="fab fa-pinterest-p" aria-hidden=true></i><span class=sr-only>Pin it</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="http://www.reddit.com/submit?url=%2fjpg-to-pdf-convertor-in-c-sharp.html" target=_blank title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden=true></i><span class=sr-only>Submit to Reddit</span></a></li></ul><style>ul.share-buttons{list-style:none;padding:0}ul.share-buttons li{display:inline}ul.share-buttons .sr-only{position:absolute;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);padding:0;border:0;height:1px;width:1px;overflow:hidden}</style><div class="prev-next-post pure-g"><div class=pure-u-1-24 style=text-align:left><a href=./kim-kardashian-and-kanye-wests-wedding-invitation-picture-201495.html><i class="fa fa-chevron-left"></i></a></div><div class=pure-u-10-24><nav class=prev><a href=./kim-kardashian-and-kanye-wests-wedding-invitation-picture-201495.html>Kim Kardashian and Kanye West's Wedding Invitation: Picture</a></nav></div><div class=pure-u-2-24>&nbsp;</div><div class=pure-u-10-24><nav class=next><a href=./how-many-siblings-does-olivia-culpo-have.html>How Many Siblings Does Olivia Culpo Have?</a></nav></div><div class=pure-u-1-24 style=text-align:right><a href=./how-many-siblings-does-olivia-culpo-have.html><i class="fa fa-chevron-right"></i></a></div></div></div></div></div><script src=https://assets.cdnweb.info/hugo/blackburn/js/ui.js></script>
<script src=https://assets.cdnweb.info/hugo/blackburn/js/menus.js></script>
<script src=./js/math-code.js></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>